---
title: "SSAC_2023"
author: "Lorenzo Dube and Xander Schwartz"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

#### Data Cleaning

Output of the below cell is two dataframes: 'continuous_df' which is all of the continuous data from the dataset and 'categorical_df' which is all of the categorical data.  Those with two categories have been 'one hot' encoded.

```{r Data_Clean}

data_path = "HackSample.xlsx"

customer = readxl::read_xlsx(data_path, sheet = 'Customer')
behavior = readxl::read_xlsx(data_path, sheet = 'Behavioral')

customer <- customer[, colSums(!is.na(customer)) > 0] #remove all NA only columns
customer <- customer[, !grepl("input_indv", names(customer))] #remove input_indv columns
behavior <- behavior[, colSums(!is.na(behavior)) > 0] #remove all NA only columns

df <- merge(customer, behavior, by = "acct_id")

one_hot_column_list <- sapply(df, function(x) all(is.na(x) | x %in% c(0,1)))
cont_value_column_list = !one_hot_column_list
one_hot_column_list[1] = TRUE

one_hot_df <- df[, one_hot_column_list]
one_hot_df[is.na(one_hot_df)] <- 0

cont_val_df = df[, cont_value_column_list]
cont_val_list2 <- sapply(cont_val_df, function(col) all(is.numeric(col) | is.na(col)))
cont_val_list2[1] = TRUE
continuous_df <- cont_val_df[, cont_val_list2]

other_cat_list = !cont_val_list2
other_cat_list[1] = TRUE
other_cat_df <- cont_val_df[, other_cat_list]

categorical_df = merge(one_hot_df, other_cat_df, by = 'acct_id')

```

## Including Plots



```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
